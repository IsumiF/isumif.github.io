<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>My Hakyll Blog - Stack error on internal libraries</title>
        <link rel="stylesheet" href="../../css/default.css" />
        <link rel="stylesheet" href="../../css/syntax.css" />
    </head>
    <body>
        <header>
            <div class="logo">
                <a href="../../">My Hakyll Blog</a>
            </div>
            <nav>
                <a href="../../">Home</a>
                <a href="../../about.html">About</a>
                <a href="../../contact.html">Contact</a>
                <a href="../../archive.html">Archive</a>
            </nav>
        </header>

        <main role="main">
            <h1>Stack error on internal libraries</h1>
            <article>
  <section class="header">
    Posted on March 17, 2019
    
  </section>
  <section>
    <p>If your dependencies include <code>typerep-map</code>, and you are on Stackage lts-13.*, you may encounter the following error message when running <code>stack haddock</code></p>
<pre><code>Run from: ***
Standard output:

haddock: internal error: ./z-typerep-map-z-typerep-extra-impls-0.3.1/z-typerep-map-z-typerep-extra-impls-0.3.1.haddock openBinaryFile: does not exist (No such file or directory)</code></pre>
<p>The lastest release of stack is 1.9.3, which doesn’t support haddocking internal libraries (a new feature of Cabal 2.0).</p>
<p>However, the problem is already <a href="https://github.com/commercialhaskell/stack/pull/4596">fixed</a> in stack’s master branch, so we may upgrade stack.</p>
<pre><code>stack upgrade --git</code></pre>
<p>If you don’t want to upgrade, there is a workaround:</p>
<ol type="1">
<li>Go to the directory mentioned as “Run from” in the error message</li>
<li>There you will find directory <code>z-typerep-map-z-typerep-extra-impls-0.3.1</code></li>
<li>Inside that directory, rename the only .haddock file to <code>z-typerep-map-z-typerep-extra-impls.haddock</code></li>
</ol>
<p>Then try <code>stack haddock</code> or <code>stack hoogle --rebuild</code> again. The problem is gone. You may receive warning about <code>z-typerep-map-z-typerep-extra-impls</code>’s documentation is missing. Just ignore it.</p>
  </section>
</article>
        </main>

        <footer>
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </footer>
    </body>
</html>
